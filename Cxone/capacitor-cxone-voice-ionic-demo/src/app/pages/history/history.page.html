<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>Call History</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="clearHistory()" *ngIf="(voiceService.callHistory$ | async)?.length">
        <ion-icon name="trash-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <ion-header collapse="condense">
    <ion-toolbar>
      <ion-title size="large">Call History</ion-title>
    </ion-toolbar>
  </ion-header>

  <ion-list *ngIf="(voiceService.callHistory$ | async) as history">
    <div *ngIf="history.length === 0" style="text-align: center; padding: 40px; color: var(--ion-color-medium);">
      <ion-icon name="time-outline" style="font-size: 64px;"></ion-icon>
      <p>No call history</p>
    </div>

    <ion-item 
      *ngFor="let item of history" 
      button 
      (click)="callNumber(item.phoneNumber)"
      detail="false">
      <ion-icon 
        [name]="getCallIcon(item)" 
        [color]="getCallColor(item)"
        slot="start"
        style="font-size: 24px;">
      </ion-icon>
      
      <ion-label>
        <h2>{{ item.displayName || item.phoneNumber }}</h2>
        <p *ngIf="item.displayName">{{ item.phoneNumber }}</p>
        <p>
          <ion-icon name="time-outline" style="font-size: 12px;"></ion-icon>
          {{ formatDuration(item.duration) }} â€¢ {{ formatDate(item.endTime) }}
        </p>
      </ion-label>

      <ion-icon 
        name="arrow-forward-outline" 
        slot="end"
        color="medium"
        *ngIf="item.direction === 'outbound'">
      </ion-icon>
      <ion-icon 
        name="arrow-back-outline" 
        slot="end"
        color="medium"
        *ngIf="item.direction === 'inbound'">
      </ion-icon>
    </ion-item>
  </ion-list>
</ion-content>